import{d as E,r as u,l as P,m as z,o as G,c as v,a as t,f as I,b as l,i as k,e as a,j as O,t as o,F as q,p as D,h as c,x as H,y as L,C as K,k as i}from"./index-FuMGBNr_.js";import{A as X}from"./arrow-left-CzJQ-YTU.js";import{T as N}from"./triangle-alert-1Rn6Vmyi.js";import{F as B}from"./file-key-CKcbrZKU.js";import{R as J}from"./rotate-ccw-Cpt0ZoDa.js";import{G as A}from"./globe-izEBIBLJ.js";import{c as j}from"./createLucideIcon-DPGb8pea.js";import{C as w}from"./check-Ib64XTCh.js";import{C}from"./copy-CDy7s6v3.js";import{C as F}from"./clock-CWxjY3HO.js";import{C as Q}from"./circle-x--W9BfU9X.js";import{C as W}from"./circle-check-big-C5mCHIra.js";const Y=j("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);const M=j("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]]);const Z=j("fingerprint-pattern",[["path",{d:"M12 10a2 2 0 0 0-2 2c0 1.02-.1 2.51-.26 4",key:"1nerag"}],["path",{d:"M14 13.12c0 2.38 0 6.38-1 8.88",key:"o46ks0"}],["path",{d:"M17.29 21.02c.12-.6.43-2.3.5-3.02",key:"ptglia"}],["path",{d:"M2 12a10 10 0 0 1 18-6",key:"ydlgp0"}],["path",{d:"M2 16h.01",key:"1gqxmh"}],["path",{d:"M21.8 16c.2-2 .131-5.354 0-6",key:"drycrb"}],["path",{d:"M5 19.5C5.5 18 6 15 6 12a6 6 0 0 1 .34-2",key:"1tidbn"}],["path",{d:"M8.65 22c.21-.66.45-1.32.57-2",key:"13wd9y"}],["path",{d:"M9 6.8a6 6 0 0 1 9 5.2v2",key:"1fr1j5"}]]),tt={class:"space-y-4"},st={key:0,class:"flex justify-center py-12"},et={key:1,class:"alert alert-error"},at={class:"card bg-base-100 shadow-sm"},nt={class:"card-body"},ot={class:"flex flex-col sm:flex-row sm:items-center justify-between gap-4 mb-4"},lt={class:"flex items-center gap-3"},it={class:"w-12 h-12 rounded-xl bg-primary/10 flex items-center justify-center"},dt={class:"text-xl font-bold"},ct=["disabled"],rt={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ut={class:"flex items-start gap-3"},mt={class:"font-medium"},pt={class:"flex items-start gap-3"},vt={class:"font-medium"},bt={class:"flex items-start gap-3"},ft={class:"font-mono text-sm break-all"},xt={class:"flex items-start gap-3"},ht={class:"font-medium"},gt={class:"card bg-base-100 shadow-sm"},yt={class:"card-body"},_t={class:"mb-4"},kt={class:"flex items-center justify-between mb-2"},wt={class:"flex gap-2"},Ct={class:"bg-base-200 rounded-lg p-3 text-xs overflow-x-auto max-h-32"},Mt={class:"mb-4"},jt={class:"flex items-center justify-between mb-2"},$t={class:"flex gap-2"},Rt={class:"bg-base-200 rounded-lg p-3 text-xs overflow-x-auto max-h-32"},Dt={class:"flex items-center justify-between mb-2"},Lt={class:"flex gap-2"},Nt={class:"bg-base-200 rounded-lg p-3 text-xs overflow-x-auto max-h-32"},Bt={class:"card bg-base-100 shadow-sm"},At={class:"card-body"},Ft={class:"flex items-center gap-3"},Tt={class:"font-medium"},Vt={class:"text-sm text-base-content/60"},St={class:"card bg-base-100 shadow-sm"},Ut={class:"card-body"},Et={class:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm"},Pt={class:"font-medium"},zt={class:"font-medium"},ss=E({__name:"CertDetail",setup(Gt){const T=z(),V=O(),e=u(null),b=u(null),f=u(!0),r=u(""),p=u(!1),m=u(""),S=P(()=>Number(T.params.id));async function $(){f.value=!0,r.value="";try{const{data:n}=await L.get(S.value);if(e.value=n,n.dns_provider_id){const{data:s}=await K.get(n.dns_provider_id);b.value=s}}catch(n){const s=n;s.response?.status===404?r.value="证书不存在":r.value=s.message||"加载失败"}finally{f.value=!1}}function x(n){switch(n){case"valid":return{class:"badge-success",icon:W,text:"有效"};case"expiring":return{class:"badge-warning",icon:F,text:"即将过期"};case"expired":return{class:"badge-error",icon:Q,text:"已过期"};case"pending":return{class:"badge-info",icon:F,text:"申请中"};default:return{class:"badge-ghost",icon:N,text:n}}}function h(n){return n?new Date(n).toLocaleString("zh-CN"):"-"}async function U(){if(e.value){p.value=!0;try{await L.renew(e.value.id),await $()}catch(n){const s=n;r.value=s.response?.data?.error?.message||"续期失败"}finally{p.value=!1}}}function g(n,s){navigator.clipboard.writeText(n),m.value=s,setTimeout(()=>{m.value=""},2e3)}function y(n,s){const d=new Blob([n],{type:"text/plain"}),R=URL.createObjectURL(d),_=document.createElement("a");_.href=R,_.download=s,_.click(),URL.revokeObjectURL(R)}return G($),(n,s)=>(i(),v("div",tt,[t("button",{class:"btn btn-ghost btn-sm gap-2",onClick:s[0]||(s[0]=d=>a(V).push("/certs"))},[l(a(X),{class:"w-4 h-4"}),s[7]||(s[7]=k(" 返回列表 ",-1))]),f.value?(i(),v("div",st,[...s[8]||(s[8]=[t("span",{class:"loading loading-spinner loading-lg"},null,-1)])])):r.value?(i(),v("div",et,[l(a(N),{class:"w-5 h-5"}),t("span",null,o(r.value),1)])):e.value?(i(),v(q,{key:2},[t("div",at,[t("div",nt,[t("div",ot,[t("div",lt,[t("div",it,[l(a(B),{class:"w-6 h-6 text-primary"})]),t("div",null,[t("h2",dt,o(e.value.domain),1),t("div",{class:D(["badge gap-1",x(e.value.status).class])},[(i(),c(H(x(e.value.status).icon),{class:"w-3 h-3"})),k(" "+o(x(e.value.status).text),1)],2)])]),t("button",{class:"btn btn-primary",disabled:p.value,onClick:U},[l(a(J),{class:D(["w-4 h-4",p.value&&"animate-spin"])},null,8,["class"]),s[9]||(s[9]=k(" 续期证书 ",-1))],8,ct)]),t("div",rt,[t("div",ut,[l(a(A),{class:"w-5 h-5 text-base-content/40 mt-0.5"}),t("div",null,[s[10]||(s[10]=t("p",{class:"text-sm text-base-content/60"},"SAN 域名",-1)),t("p",mt,o(e.value.san&&e.value.san.length>0?e.value.san.join(", "):"-"),1)])]),t("div",pt,[l(a(Y),{class:"w-5 h-5 text-base-content/40 mt-0.5"}),t("div",null,[s[11]||(s[11]=t("p",{class:"text-sm text-base-content/60"},"过期时间",-1)),t("p",vt,o(h(e.value.expires_at)),1)])]),t("div",bt,[l(a(Z),{class:"w-5 h-5 text-base-content/40 mt-0.5"}),t("div",null,[s[12]||(s[12]=t("p",{class:"text-sm text-base-content/60"},"指纹",-1)),t("p",ft,o(e.value.fingerprint||"-"),1)])]),t("div",xt,[l(a(B),{class:"w-5 h-5 text-base-content/40 mt-0.5"}),t("div",null,[s[13]||(s[13]=t("p",{class:"text-sm text-base-content/60"},"颁发者",-1)),t("p",ht,o(e.value.issuer||"Let's Encrypt"),1)])])])])]),t("div",gt,[t("div",yt,[s[17]||(s[17]=t("h3",{class:"card-title text-lg mb-4"},"证书文件",-1)),t("div",_t,[t("div",kt,[s[14]||(s[14]=t("span",{class:"font-medium"},"证书 (cert.pem)",-1)),t("div",wt,[t("button",{class:"btn btn-ghost btn-xs",onClick:s[1]||(s[1]=d=>g(e.value.cert_pem,"cert"))},[m.value==="cert"?(i(),c(a(w),{key:0,class:"w-4 h-4 text-success"})):(i(),c(a(C),{key:1,class:"w-4 h-4"}))]),t("button",{class:"btn btn-ghost btn-xs",onClick:s[2]||(s[2]=d=>y(e.value.cert_pem,`${e.value.domain}-cert.pem`))},[l(a(M),{class:"w-4 h-4"})])])]),t("pre",Ct,o(e.value.cert_pem||"暂无"),1)]),t("div",Mt,[t("div",jt,[s[15]||(s[15]=t("span",{class:"font-medium"},"私钥 (key.pem)",-1)),t("div",$t,[t("button",{class:"btn btn-ghost btn-xs",onClick:s[3]||(s[3]=d=>g(e.value.key_pem,"key"))},[m.value==="key"?(i(),c(a(w),{key:0,class:"w-4 h-4 text-success"})):(i(),c(a(C),{key:1,class:"w-4 h-4"}))]),t("button",{class:"btn btn-ghost btn-xs",onClick:s[4]||(s[4]=d=>y(e.value.key_pem,`${e.value.domain}-key.pem`))},[l(a(M),{class:"w-4 h-4"})])])]),t("pre",Rt,o(e.value.key_pem?"******** (已隐藏)":"暂无"),1)]),t("div",null,[t("div",Dt,[s[16]||(s[16]=t("span",{class:"font-medium"},"完整链 (fullchain.pem)",-1)),t("div",Lt,[t("button",{class:"btn btn-ghost btn-xs",onClick:s[5]||(s[5]=d=>g(e.value.fullchain_pem,"fullchain"))},[m.value==="fullchain"?(i(),c(a(w),{key:0,class:"w-4 h-4 text-success"})):(i(),c(a(C),{key:1,class:"w-4 h-4"}))]),t("button",{class:"btn btn-ghost btn-xs",onClick:s[6]||(s[6]=d=>y(e.value.fullchain_pem,`${e.value.domain}-fullchain.pem`))},[l(a(M),{class:"w-4 h-4"})])])]),t("pre",Nt,o(e.value.fullchain_pem||"暂无"),1)])])]),t("div",Bt,[t("div",At,[s[18]||(s[18]=t("h3",{class:"card-title text-lg mb-4"},"DNS 信息",-1)),t("div",Ft,[l(a(A),{class:"w-5 h-5 text-base-content/40"}),t("div",null,[t("p",Tt,o(b.value?.name||"-"),1),t("p",Vt,o(b.value?.type||"-"),1)])])])]),t("div",St,[t("div",Ut,[s[21]||(s[21]=t("h3",{class:"card-title text-lg mb-4"},"时间信息",-1)),t("div",Et,[t("div",null,[s[19]||(s[19]=t("p",{class:"text-base-content/60"},"创建时间",-1)),t("p",Pt,o(h(e.value.created_at)),1)]),t("div",null,[s[20]||(s[20]=t("p",{class:"text-base-content/60"},"更新时间",-1)),t("p",zt,o(h(e.value.updated_at)),1)])])])])],64)):I("",!0)]))}});export{ss as default};
