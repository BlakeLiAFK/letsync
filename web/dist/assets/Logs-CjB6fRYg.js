import{d as N,r as c,G as S,o as T,c as o,a as e,f as b,g as w,B as M,F as g,n as p,b as h,i as C,p as y,e as x,t as i,H as U,h as q,x as A,k as l}from"./index-FuMGBNr_.js";import{R as I}from"./refresh-cw-B5UK-0jM.js";import{T as j}from"./triangle-alert-1Rn6Vmyi.js";import{S as F}from"./scroll-text-nTKQ9pKm.js";import{c as k}from"./createLucideIcon-DPGb8pea.js";const H=k("bug",[["path",{d:"M12 20v-9",key:"1qisl0"}],["path",{d:"M14 7a4 4 0 0 1 4 4v3a6 6 0 0 1-12 0v-3a4 4 0 0 1 4-4z",key:"uouzyp"}],["path",{d:"M14.12 3.88 16 2",key:"qol33r"}],["path",{d:"M21 21a4 4 0 0 0-3.81-4",key:"1b0z45"}],["path",{d:"M21 5a4 4 0 0 1-3.55 3.97",key:"5cxbf6"}],["path",{d:"M22 13h-4",key:"1jl80f"}],["path",{d:"M3 21a4 4 0 0 1 3.81-4",key:"1fjd4g"}],["path",{d:"M3 5a4 4 0 0 0 3.55 3.97",key:"1d7oge"}],["path",{d:"M6 13H2",key:"82j7cp"}],["path",{d:"m8 2 1.88 1.88",key:"fmnt4t"}],["path",{d:"M9 7.13V6a3 3 0 1 1 6 0v1.13",key:"1vgav8"}]]);const R=k("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);const V=k("info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),E={class:"space-y-4"},G={class:"flex flex-col sm:flex-row gap-3 justify-between"},$={class:"flex flex-wrap gap-2"},J=["value"],K=["value"],O=["disabled"],P={key:0,class:"alert alert-error"},Q={key:1,class:"flex justify-center py-12"},W={key:2,class:"card bg-base-100 shadow-sm"},X={class:"card-body items-center text-center py-12"},Y={class:"w-16 h-16 rounded-full bg-base-200 flex items-center justify-center mb-4"},Z={key:3,class:"card bg-base-100 shadow-sm overflow-hidden"},ee={class:"overflow-x-auto"},te={class:"table table-sm table-zebra"},se={class:"flex items-center gap-1"},ae={class:"badge badge-xs badge-ghost"},le={class:"text-xs text-base-content/60 whitespace-nowrap"},oe=["title"],ne={key:0,class:"flex justify-center p-4 border-t border-base-200"},de=["disabled"],ie={key:0,class:"loading loading-spinner loading-sm"},re={class:"text-center text-sm text-base-content/60"},ge=N({__name:"Logs",setup(ce){const n=c([]),r=c(!0),u=c(""),a=c({level:"",module:"",limit:50,offset:0}),z=["auth","cert","agent","dns","scheduler","notify","acme"],B=["debug","info","warn","error"],_=c(!0);async function v(d=!1){d&&(a.value.offset=0,n.value=[]),r.value=!0,u.value="";try{const t={limit:a.value.limit,offset:a.value.offset};a.value.level&&(t.level=a.value.level),a.value.module&&(t.module=a.value.module);const{data:s}=await U.list(t),m=s||[];d?n.value=m:n.value=[...n.value,...m],_.value=m.length===a.value.limit}catch(t){const s=t;u.value=s.message||"加载失败"}finally{r.value=!1}}function D(){a.value.offset+=a.value.limit,v()}function L(d){return d?new Date(d).toLocaleString("zh-CN",{month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}):"-"}function f(d){switch(d){case"error":return{icon:R,class:"text-error",badge:"badge-error"};case"warn":return{icon:j,class:"text-warning",badge:"badge-warning"};case"info":return{icon:V,class:"text-info",badge:"badge-info"};case"debug":return{icon:H,class:"text-base-content/60",badge:"badge-ghost"};default:return{icon:V,class:"text-base-content/60",badge:"badge-ghost"}}}return S([()=>a.value.level,()=>a.value.module],()=>{v(!0)}),T(()=>v(!0)),(d,t)=>(l(),o("div",E,[e("div",G,[e("div",$,[w(e("select",{"onUpdate:modelValue":t[0]||(t[0]=s=>a.value.level=s),class:"select select-bordered select-sm"},[t[3]||(t[3]=e("option",{value:""},"全部级别",-1)),(l(),o(g,null,p(B,s=>e("option",{key:s,value:s},i(s.toUpperCase()),9,J)),64))],512),[[M,a.value.level]]),w(e("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>a.value.module=s),class:"select select-bordered select-sm"},[t[4]||(t[4]=e("option",{value:""},"全部模块",-1)),(l(),o(g,null,p(z,s=>e("option",{key:s,value:s},i(s),9,K)),64))],512),[[M,a.value.module]])]),e("button",{class:"btn btn-ghost btn-sm",onClick:t[2]||(t[2]=s=>v(!0)),disabled:r.value},[h(x(I),{class:y(["w-4 h-4",r.value&&"animate-spin"])},null,8,["class"]),t[5]||(t[5]=C(" 刷新 ",-1))],8,O)]),u.value?(l(),o("div",P,[h(x(j),{class:"w-5 h-5"}),e("span",null,i(u.value),1)])):b("",!0),r.value&&n.value.length===0?(l(),o("div",Q,[...t[6]||(t[6]=[e("span",{class:"loading loading-spinner loading-lg"},null,-1)])])):n.value.length===0?(l(),o("div",W,[e("div",X,[e("div",Y,[h(x(F),{class:"w-8 h-8 text-base-content/40"})]),t[7]||(t[7]=e("h3",{class:"text-lg font-semibold"},"暂无日志",-1)),t[8]||(t[8]=e("p",{class:"text-base-content/60"},"系统日志将在此显示",-1))])])):(l(),o("div",Z,[e("div",ee,[e("table",te,[t[9]||(t[9]=e("thead",null,[e("tr",{class:"bg-base-200"},[e("th",{class:"w-20"},"级别"),e("th",{class:"w-24"},"模块"),e("th",{class:"w-36"},"时间"),e("th",null,"消息")])],-1)),e("tbody",null,[(l(!0),o(g,null,p(n.value,s=>(l(),o("tr",{key:s.id,class:"hover"},[e("td",null,[e("div",se,[(l(),q(A(f(s.level).icon),{class:y(["w-3 h-3",f(s.level).class])},null,8,["class"])),e("span",{class:y(["badge badge-xs",f(s.level).badge])},i(s.level.toUpperCase()),3)])]),e("td",null,[e("span",ae,i(s.module),1)]),e("td",le,i(L(s.created_at)),1),e("td",{class:"text-sm max-w-md truncate",title:s.message},i(s.message),9,oe)]))),128))])])]),_.value?(l(),o("div",ne,[e("button",{class:"btn btn-ghost btn-sm",onClick:D,disabled:r.value},[r.value?(l(),o("span",ie)):b("",!0),t[10]||(t[10]=C(" 加载更多 ",-1))],8,de)])):b("",!0)])),e("div",re," 已加载 "+i(n.value.length)+" 条日志 ",1)]))}});export{ge as default};
